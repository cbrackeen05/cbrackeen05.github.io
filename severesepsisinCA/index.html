<html>
<script src="https://d3js.org/d3.v7.min.js"></script>

<head>
<title>Severe Sepsis in California</title>
</head>
  
<div style="position:relative; left:80px; top:2px;">
<h1>Severe Sepsis Cases in California</h1>
  <h2> Severe sepsis is a constant threat in hospitals as
  it is has the number one cost of hospitalization in<br>
  the United States an on average 30% of patients 
  diagnosed with the disease do not survive. </p></h2>
</div>
 
<body onload='init()'>
<svg width=1100 height=1000>
</svg>

  
<script>
async function init() {
var data = await d3.csv("https://raw.githubusercontent.com/cbrackeen05/cbrackeen05.github.io/main/severesepsisinCA/ca_severesep.csv");

var y_cases = d3.scaleLinear().domain([100000,300000]).range([500,0])
var x_year = d3.scaleLinear().domain([2010,2019]).range([0,600])
var y_mort = d3.scaleLinear().domain([0.10,0.30]).range([500,0])

const transitionPath = d3.transition().duration(2500)
const transitionDots = d3.transition().duration(4000)

const caseDots = d3
.select('svg')
.append('g').attr('transform','translate(400,10)')
.selectAll('circle').data(data).enter().append('circle')
.attr("cx",function(d){return x_year(d.Year);})
.attr("cy",function(d){return y_cases(d.SS_Cases);})
.attr("r",2)

caseDots
.style("fill","none")
.style("stroke","none")
.transition(transitionDots)
.attr("fill","lightblue")
.attr("stroke","black")
  
const caseLine = d3
.select('svg')
.append('g').attr('transform','translate(400,10)')
.append('path').datum(data)
.attr("fill","none")
.attr("stroke","black")
.attr("stroke-width", 1.5)
.attr("d", d3.line()
   .x(function(d){return x_year(d.Year);})
   .y(function(d){return y_cases(d.SS_Cases);})
  )

const casePathLength = caseLine.node().getTotalLength();
  
caseLine
  .attr("stroke-dashoffset", casePathLength)
  .attr("stroke-dasharray", casePathLength)
  .transition(transitionPath)
  .attr("stroke-dashoffset", 0);

const mortDots = d3
.select('svg')
.append('g').attr('transform','translate(400,10)')
.selectAll('circle').data(data).enter().append('circle')
.attr("cx",function(d){return x_year(d.Year);})
.attr("cy",function(d){return y_mort(d.SS_Mortality);})
.attr("r",2)

mortDots
.style("fill","none")
.style("stroke","none")
.transition(transitionDots)
.attr("fill","lightblue")
.attr("stroke","black")
  
const mortLine = d3
.select('svg')
.append('g').attr('transform','translate(400,10)')
.append('path').datum(data)
.attr("fill","none")
.attr("stroke","black")
.attr("stroke-width", 1.5)
.attr("d", d3.line()
   .x(function(d){return x_year(d.Year);})
   .y(function(d){return y_mort(d.SS_Mortality);})
  );

const mortPathLength = mortLine.node().getTotalLength();

mortLine
  .attr("stroke-dashoffset", mortPathLength)
  .attr("stroke-dasharray", mortPathLength)
  .transition(transitionPath)
  .attr("stroke-dashoffset", 0);

d3.select('svg')
.append('g').attr('transform','translate(400,10)')
.call(d3.axisLeft(y_cases))
  
d3.select('svg')
.append('g').attr('transform','translate(1000,10)')
.call(d3.axisRight(y_mort))
  
d3.select('svg')
.append('g').attr('transform','translate(400,510)')
.call(d3.axisBottom(x_year))
  
}
</script>
</body>
</html>
